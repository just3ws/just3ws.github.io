{% assign asset = include.asset %}
{% if asset %}
  {% assign has_transcript = false %}
  {% assign transcript_entry = nil %}
  {% if asset.transcript_id %}
    {% assign transcript_entry = site.data.transcripts[asset.transcript_id] %}
    {% if transcript_entry and transcript_entry.content %}
      {% assign has_transcript = true %}
    {% endif %}
  {% endif %}
  {% assign preferred = nil %}
  {% if asset.primary_platform %}
    {% assign preferred = asset.platforms | where: "platform", asset.primary_platform | first %}
  {% endif %}
  {% if preferred == nil %}{% assign preferred = asset.platforms | first %}{% endif %}
  {% assign detail_url = "/videos/" | append: asset.id | append: "/" %}
  {% assign thumb = preferred.thumbnail | default: asset.thumbnail %}

  <div class="video{% if has_transcript %} has-transcript{% endif %}">
    {% if thumb %}
      <a class="video-thumb" href="{{ detail_url }}">
        <img src="{{ thumb }}" alt="Thumbnail for {{ asset.title }}">
      </a>
    {% endif %}
    <div class="video-body">
      <div class="video-title"><a href="{{ detail_url }}">{{ asset.title }}</a></div>
      {% if has_transcript %}
        <div class="video-indicators">
          <span class="video-indicator transcript" aria-label="Transcript available">â˜… Transcript Available</span>
        </div>
      {% endif %}
      <div class="video-meta">
        {% if asset.published_date %}Published: {{ asset.published_date | date: "%b %d, %Y" }}{% elsif preferred and preferred.published_date %}Published: {{ preferred.published_date | date: "%b %d, %Y" }}{% endif %}
      </div>
      <div class="video-actions">
        <a class="video-button primary" href="{{ detail_url }}">Watch Here</a>
        {% if preferred and preferred.url %}<a class="video-button" href="{{ preferred.url }}">Watch on {{ preferred.platform | capitalize }}</a>{% endif %}
      </div>
    </div>
  </div>
{% endif %}
