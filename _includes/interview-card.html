{% assign assets = site.data.video_assets.items | where: "interview_id", interview.id %}
{% assign vimeo = assets | where: "platform", "vimeo" | first %}
{% assign youtube = assets | where: "platform", "youtube" | first %}
{% assign preferred = vimeo | default: youtube %}
{% assign primary_url = "/interviews/" | append: interview.id | append: "/" %}
{% assign thumb = preferred.thumbnail_local | default: preferred.thumbnail %}

<div class="video">
  {% if thumb %}
    <a class="video-thumb" href="{{ primary_url }}">
      <img src="{{ thumb }}" alt="Thumbnail for {{ interview.title }}">
    </a>
  {% endif %}
  <div class="video-body">
    <div class="video-title"><a href="{{ primary_url }}">{{ interview.title }}</a></div>
    {% if interview.interviewees and interview.interviewees.size > 0 %}
      <div class="video-subtitle">Interviewee{% if interview.interviewees.size > 1 %}s{% endif %}: {{ interview.interviewees | join: ", " }}</div>
    {% endif %}
    {% if interview.topic %}
      <div class="video-subtitle">Topic: {{ interview.topic }}</div>
    {% endif %}
    <div class="video-meta">
      {% if preferred.duration_minutes %}Duration: {{ preferred.duration_minutes | round }} min · {% endif %}{% if preferred.published_date %}Uploaded: {{ preferred.published_date | date: "%b %d, %Y" }}{% endif %}
    </div>
    <div class="video-meta">
      {% if interview.conference %}Conference: {{ interview.conference }}{% if interview.conference_year %} {{ interview.conference_year }}{% endif %}{% endif %}
      {% if interview.community %}{% if interview.conference %} · {% endif %}Community: {{ interview.community }}{% endif %}
    </div>
    <div class="video-actions">
      <a class="video-button primary" href="{{ primary_url }}">View Interview</a>
      {% if preferred and preferred.url %}<a class="video-button" href="{{ preferred.url }}">Watch on {{ preferred.platform | capitalize }}</a>{% endif %}
    </div>
    {% if preferred.tags and preferred.tags.size > 0 %}
      <div class="video-tags">
        {% for tag in preferred.tags %}
          <span class="tag">{{ tag }}</span>
        {% endfor %}
      </div>
    {% endif %}
    {% if preferred.description %}
      <div class="video-description"><span class="video-description-label">Video description:</span> {{ preferred.description }}</div>
    {% endif %}
  </div>
</div>
